<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Team Rocket Crypto Challenge - CTF</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'rocket-red': '#DC2626',
                        'rocket-black': '#1F2937',
                        'electric-yellow': '#FCD34D',
                        'psychic-purple': '#8B5CF6'
                    },
                    fontFamily: {
                        'retro': ['Orbitron', 'monospace'],
                        'mono': ['Fira Code', 'monospace']
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Fira+Code:wght@300;400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/custom.css') }}">
</head>
<body class="bg-gradient-to-br from-gray-900 via-rocket-black to-black min-h-screen text-white matrix-bg">
    
    <!-- Anti-cheat overlay -->
    <div id="security-overlay" class="hidden fixed inset-0 bg-red-900 bg-opacity-95 z-50 flex items-center justify-center">
        <div class="text-center animate-pulse">
            <div class="text-6xl mb-4">‚ö†Ô∏è</div>
            <h1 class="font-retro text-4xl text-yellow-400 mb-4">SECURITY BREACH DETECTED</h1>
            <p class="text-xl">Team Rocket Security Protocol Activated</p>
            <p class="text-sm mt-2 text-gray-300">Close developer tools to continue</p>
        </div>
    </div>

    <!-- Main container -->
    <div class="container mx-auto px-4 py-6 max-w-7xl">
        
        <!-- Header -->
        <header class="text-center mb-8 lg:mb-12">
            <div class="relative">
                <h1 class="font-retro text-3xl md:text-5xl lg:text-7xl text-transparent bg-clip-text bg-gradient-to-r from-rocket-red to-electric-yellow mb-4 glow">
                    üöÄ TEAM ROCKET CRYPTO FACILITY üöÄ
                </h1>
            </div>
            <p class="text-lg md:text-xl text-gray-300 mb-2">Advanced Cryptographic Infiltration Challenge</p>
            <div class="flex flex-wrap justify-center gap-2 mt-4">
                <span class="bg-rocket-red px-3 py-1 rounded-full text-xs font-retro">REVERSE ENGINEERING</span>
                <span class="bg-psychic-purple px-3 py-1 rounded-full text-xs font-retro">CRYPTOGRAPHY</span>
                <span class="bg-green-600 px-3 py-1 rounded-full text-xs font-retro">EXPLOITATION</span>
                <span class="bg-yellow-600 px-3 py-1 rounded-full text-xs font-retro">HARD</span>
            </div>
        </header>

        <!-- Mission briefing -->
        <section class="bg-gradient-to-r from-rocket-black to-gray-800 rounded-xl p-6 lg:p-8 mb-8 border border-rocket-red shadow-2xl">
            <h2 class="font-retro text-xl lg:text-2xl text-electric-yellow mb-4 flex items-center">
                üìã MISSION BRIEFING
            </h2>
            <div id="mission-content" class="space-y-4 text-gray-300">
                <p class="text-sm lg:text-base">üéØ <strong class="text-rocket-red">OPERATION: CRYPTO ROCKET</strong></p>
                <p class="text-sm lg:text-base">Agent, you've successfully infiltrated Team Rocket's secret cryptographic facility. Intelligence suggests they're using a multi-layered security system to protect their master plan.</p>
                <div class="bg-black bg-opacity-50 rounded-lg p-4 mt-4">
                    <h3 class="text-electric-yellow font-retro text-sm mb-2">PRIMARY OBJECTIVES:</h3>
                    <ul class="text-xs lg:text-sm space-y-1 text-gray-400">
                        <li>‚Ä¢ Analyze intercepted binary protocol communications</li>
                        <li>‚Ä¢ Exploit vulnerabilities in their Pok√©dex database system</li>
                        <li>‚Ä¢ Reverse engineer custom encryption algorithms</li>
                        <li>‚Ä¢ Chain multiple exploits to recover the master flag</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Control panel -->
        <section class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
            <button onclick="loadChallengeData()" 
                    class="group bg-gradient-to-r from-rocket-red to-red-700 hover:from-red-600 hover:to-red-800 text-white font-retro py-4 px-6 rounded-xl border-2 border-red-400 transition-all duration-300 transform hover:scale-105 shadow-lg">
                <div class="flex items-center justify-center space-x-2">
                    <span class="text-2xl">üîç</span>
                    <span class="text-sm lg:text-base">INITIATE SCAN</span>
                </div>
            </button>
            
            <button onclick="requestHint()" 
                    class="group bg-gradient-to-r from-psychic-purple to-purple-700 hover:from-purple-600 hover:to-purple-800 text-white font-retro py-4 px-6 rounded-xl border-2 border-purple-400 transition-all duration-300 transform hover:scale-105 shadow-lg">
                <div class="flex items-center justify-center space-x-2">
                    <span class="text-2xl">üí°</span>
                    <span class="text-sm lg:text-base">REQUEST INTEL</span>
                </div>
            </button>
            
            <button onclick="openSubmissionModal()" 
                    class="group bg-gradient-to-r from-green-600 to-green-700 hover:from-green-500 hover:to-green-800 text-white font-retro py-4 px-6 rounded-xl border-2 border-green-400 transition-all duration-300 transform hover:scale-105 shadow-lg">
                <div class="flex items-center justify-center space-x-2">
                    <span class="text-2xl">üéØ</span>
                    <span class="text-sm lg:text-base">SUBMIT FLAG</span>
                </div>
            </button>
        </section>

        <!-- Main analysis panels -->
        <div class="grid grid-cols-1 xl:grid-cols-2 gap-6 mb-8">
            
            <!-- Protocol analyzer -->
            <section class="bg-rocket-black bg-opacity-80 rounded-xl p-6 border border-gray-600 shadow-xl">
                <h2 class="font-retro text-lg lg:text-xl text-electric-yellow mb-4 flex items-center">
                    üîß BINARY PROTOCOL ANALYZER
                </h2>
                <div class="space-y-4">
                    <div>
                        <label class="block text-gray-300 mb-2 text-sm">Intercepted Binary Data (Hex):</label>
                        <textarea id="protocol-input" 
                                  class="w-full bg-black text-green-400 font-mono p-3 rounded border border-gray-600 h-24 text-xs lg:text-sm resize-none"
                                  placeholder="52 4F 43 4B 01 00 19 00 42 00 0C 54 59 50 45 5F 44 41 54 41 XX"></textarea>
                    </div>
                    <button onclick="analyzeProtocol()" 
                            class="w-full bg-blue-600 hover:bg-blue-700 text-white font-retro py-2 px-4 rounded transition-colors text-sm">
                        üîç ANALYZE PROTOCOL
                    </button>
                    <div id="protocol-output" class="bg-black rounded p-3 font-mono text-green-400 min-h-24 text-xs overflow-x-auto">
                        <div class="text-yellow-400">// Protocol analysis results will appear here...</div>
                        <div class="text-gray-500">// Look for patterns in Team Rocket's communication format</div>
                    </div>
                </div>
            </section>

            <!-- Database interface -->
            <section class="bg-rocket-black bg-opacity-80 rounded-xl p-6 border border-gray-600 shadow-xl">
                <h2 class="font-retro text-lg lg:text-xl text-electric-yellow mb-4 flex items-center">
                    üóÉÔ∏è POK√âDEX DATABASE
                </h2>
                <div class="space-y-4">
                    <div>
                        <label class="block text-gray-300 mb-2 text-sm">Search Query:</label>
                        <div class="flex">
                            <input id="db-search-input" type="text" 
                                   class="flex-1 bg-black text-green-400 font-mono p-3 rounded-l border border-gray-600 text-sm"
                                   placeholder="Enter Pok√©mon name or SQL...">
                            <button onclick="searchDatabase()" 
                                    class="bg-rocket-red hover:bg-red-700 text-white font-retro py-2 px-4 rounded-r transition-colors text-sm">
                                üîç
                            </button>
                        </div>
                        <div class="text-xs text-gray-400 mt-1">
                            üí° Hint: Team Rocket's input validation might be... imperfect
                        </div>
                    </div>
                    <div id="database-output" class="bg-black rounded p-3 font-mono text-green-400 min-h-24 text-xs overflow-x-auto">
                        <div class="text-yellow-400">// Database search results will appear here...</div>
                        <div class="text-gray-500">// Try searching for different Pok√©mon names</div>
                    </div>
                </div>
            </section>
        </div>

        <!-- Cryptographic analysis -->
        <section class="bg-rocket-black bg-opacity-80 rounded-xl p-6 border border-gray-600 shadow-xl mb-8">
            <h2 class="font-retro text-lg lg:text-xl text-electric-yellow mb-4 flex items-center">
                üîê CRYPTOGRAPHIC ANALYSIS STATION
            </h2>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div>
                    <label class="block text-gray-300 mb-2 text-sm">Encrypted Data Analysis:</label>
                    <textarea id="crypto-input" 
                              class="w-full bg-black text-green-400 font-mono p-3 rounded border border-gray-600 h-32 text-xs resize-none"
                              placeholder="Base64 encrypted data will appear here after scanning..."></textarea>
                    <div class="grid grid-cols-2 lg:grid-cols-4 gap-2 mt-2">
                        <button onclick="frequencyAnalysis()" 
                                class="bg-indigo-600 hover:bg-indigo-700 text-white font-retro py-1 px-2 rounded text-xs">
                            üìä FREQ
                        </button>
                        <button onclick="entropyCheck()" 
                                class="bg-indigo-600 hover:bg-indigo-700 text-white font-retro py-1 px-2 rounded text-xs">
                            üìà ENTROPY
                        </button>
                        <button onclick="patternSearch()" 
                                class="bg-indigo-600 hover:bg-indigo-700 text-white font-retro py-1 px-2 rounded text-xs">
                            üîç PATTERN
                        </button>
                        <button onclick="decryptAttempt()" 
                                class="bg-green-600 hover:bg-green-700 text-white font-retro py-1 px-2 rounded text-xs">
                            üîì DECRYPT
                        </button>
                    </div>
                </div>
                <div>
                    <div class="bg-black rounded p-3 font-mono text-green-400 h-40 overflow-y-auto text-xs">
                        <div id="crypto-output" class="space-y-1">
                            <div class="text-yellow-400">// Cryptographic analysis results...</div>
                            <div class="text-gray-500">// Multiple encryption layers detected</div>
                            <div class="text-gray-500">// Custom algorithm based on Pok√©mon type system</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Intel panel -->
        <section class="bg-rocket-black bg-opacity-80 rounded-xl p-6 border border-gray-600 shadow-xl">
            <h2 class="font-retro text-lg lg:text-xl text-electric-yellow mb-4 flex items-center">
                üì° INTELLIGENCE FEED
            </h2>
            <div id="intel-output" class="bg-black rounded p-4 font-mono text-blue-400 min-h-24 text-xs lg:text-sm">
                <div class="text-yellow-400">// Intelligence updates will appear here...</div>
                <div class="text-gray-500">// Use "REQUEST INTEL" to get progressive hints</div>
            </div>
            <div class="mt-4 flex justify-between items-center text-xs">
                <span class="text-gray-400">Intel Level: <span id="intel-level" class="text-electric-yellow font-bold">0</span>/5</span>
                <span class="text-gray-400">Classification: <span class="text-rocket-red">TOP SECRET</span></span>
            </div>
        </section>
    </div>

    <!-- Submission Modal -->
    <div id="submission-modal" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-40 p-4">
        <div class="bg-rocket-black rounded-xl p-6 lg:p-8 max-w-2xl w-full border border-rocket-red shadow-2xl">
            <h2 class="font-retro text-xl lg:text-2xl text-electric-yellow mb-4">üéØ FLAG SUBMISSION</h2>
            <div class="space-y-4">
                <div>
                    <label class="block text-gray-300 mb-2 text-sm">Decryption Algorithm:</label>
                    <select id="algorithm-select" class="w-full bg-black text-green-400 font-mono p-3 rounded border border-gray-600 text-sm">
                        <option value="">Select algorithm...</option>
                        <option value="team_rocket_multi_layer">Team Rocket Multi-Layer Cipher</option>
                        <option value="pokemon_type_cipher">Pok√©mon Type Effectiveness Cipher</option>
                        <option value="standard_aes">Standard AES Encryption</option>
                    </select>
                </div>
                <div>
                    <label class="block text-gray-300 mb-2 text-sm">Key Material:</label>
                    <textarea id="key-material" 
                              class="w-full bg-black text-green-400 font-mono p-3 rounded border border-gray-600 h-20 text-sm resize-none"
                              placeholder="Enter discovered key material..."></textarea>
                </div>
                <div>
                    <label class="block text-gray-300 mb-2 text-sm">Final Flag (Optional):</label>
                    <input id="flag-input" type="text" 
                           class="w-full bg-black text-green-400 font-mono p-3 rounded border border-gray-600 text-sm"
                           placeholder="CTF{...}">
                </div>
                <div class="flex space-x-4">
                    <button onclick="submitFlag()" 
                            class="flex-1 bg-green-600 hover:bg-green-700 text-white font-retro py-2 px-6 rounded transition-colors">
                        üöÄ SUBMIT
                    </button>
                    <button onclick="closeSubmissionModal()" 
                            class="flex-1 bg-gray-600 hover:bg-gray-700 text-white font-retro py-2 px-6 rounded transition-colors">
                        ‚ùå CANCEL
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="success-modal" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-40 p-4">
        <div class="bg-green-800 rounded-xl p-6 lg:p-8 max-w-lg w-full border border-green-600 shadow-2xl text-center">
            <div class="text-6xl mb-4">üéâ</div>
            <h2 class="font-retro text-2xl text-electric-yellow mb-4">MISSION ACCOMPLISHED!</h2>
            <p class="text-green-300 mb-4">You successfully infiltrated Team Rocket's crypto system!</p>
            <div class="bg-black rounded p-4 font-mono text-green-400 mb-4 text-sm">
                <div class="text-yellow-400">DECRYPTED FLAG:</div>
                <div id="final-flag" class="text-xl font-bold text-electric-yellow"></div>
            </div>
            <button onclick="closeSuccessModal()" 
                    class="bg-green-600 hover:bg-green-700 text-white font-retro py-2 px-6 rounded transition-colors">
                üéä EXCELLENT!
            </button>
        </div>
    </div>

    <!-- Loading overlay -->
    <div id="loading-overlay" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-30">
        <div class="bg-rocket-black rounded-xl p-8 border border-rocket-red">
            <div class="text-center">
                <div class="animate-spin text-4xl mb-4">‚ö°</div>
                <p class="font-retro text-electric-yellow">Processing...</p>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
